---
layout: post
title: Deploy Jekyll in Heroku with Custom Domain
author: ndaru
categories: ["heroku", "jekyll", "custom-domain"]
image: https://cdn-images-1.medium.com/max/1024/1*uGUWRoXNAh3w0_xMd0nWIA.png
---
<p>How to deploy Jekyll in Heroku using free dynos and using cloudflare as DNS for custom domain</p><p>These article is alternate story from <a href="https://medium.com/@kusumandaru/create-personal-website-on-second-152339342b7c">previous article</a> about jekyll and custom domain. Instead using github page, we try to adopt Heroku free tier. Skip to step 4 if you ever read above article.</p><p><strong>Part 1 — choose a custom domain</strong></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*uGUWRoXNAh3w0_xMd0nWIA.png" /><figcaption>domain registration</figcaption></figure><p>You can buy with various domain provider like GoDaddy, Wix, 101domain or many option outside there, for this example I use Namecheap.</p><p>Some domain like .com need activation via email to check owner validity.</p><p><strong>Part 2— Using cloudflare to inject https</strong></p><p>We use cloudflare to connect custom domain with CNAME on heroku</p><p>Register first on <a href="https://www.cloudflare.com/">https://www.cloudflare.com/</a></p><figure><img alt="" src="https://cdn-images-1.medium.com/max/832/1*8NbToPoehLquG87WX7LcZg.png" /><figcaption>fill custom domain name</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/666/1*kGTJWcFqvz4y_v5Jkb9ljA.png" /><figcaption>choose free option</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*MTLjmTVwVzTVPv5nzDNuWA.png" /><figcaption>update domain setting to using cloudflare dns</figcaption></figure><p>On your hosting change Nameservers default dns into cloudflare dns.</p><p>lia.ns.cloudflare.com for dns1</p><p>west.ns.cloudflare.com for dns2</p><p>It cost several hours until days depends on domain provider, check status on overview tab.</p><p>Than go to crypto tab than set ssl to on, it will redirect any http request to https and use ssl from cloud flare.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*k5QAmRIl7YkbaW9PcMA3cw.png" /><figcaption>crypto area</figcaption></figure><p>Also turn check on Automatic https rewrite in Edge Certificates to make assets to use HTTPS when eligible, rather than HTTP</p><p>Your site now already using https</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/704/1*L0eG2mrD4sV4qg4BCg9FzQ.png" /><figcaption>already force using ssl</figcaption></figure><p><strong>Part 3— Using jekyll to generate website</strong></p><p>Choose theme from github page theme from <a href="https://jekyllthemes.io/">https://jekyllthemes.io/</a></p><p>or just install jekyll using jekyll new blog</p><p>Build using command bundle exec jekyll build and check with bundle exec jekyll server.</p><p>check on localhost:4000</p><p><strong>Part 4 — Install Heroku on Jekyll</strong></p><p>Register heroku free dynos <a href="https://www.heroku.com/free">here</a></p><p>Install heroku client using <a href="http://brew install heroku/brew/heroku">brew</a> brew install heroku/brew/heroku</p><p>Create project name using heroku create {name of project}</p><p>Adding ruby dependencies using heroku buildpacks:add heroku/ruby</p><p>Since jekyll generate static website to host static website we must install static web using heroku buildpacks:add <a href="https://github.com/heroku/heroku-buildpack-static">https://github.com/heroku/heroku-buildpack-static</a></p><p>add static.json and Rakefile on root path</p><iframe src="" width="0" height="0" frameborder="0" scrolling="no"><a href="https://medium.com/media/e9716fb8458e073d971e3af35b79bf34/href">https://medium.com/media/e9716fb8458e073d971e3af35b79bf34/href</a></iframe><p>Root file is located for generated jekyll and Rakefile to build command rake assets:precompile</p><p>For deploy using branch, use git push heroku {name of branch}:master</p><p>example: git push heroku heroku:master</p><p>Than link custom domainheroku domains:add blog.kusumandaru.com</p><p>Check domain creation using heroku domains:wait ‘blog.kusumandaru.com&#39;</p><p>Check domain setup using heroku domains to check DNS and CNAME</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*J5kKWdMwBrqrg_LXZJjSkg.png" /><figcaption>custom domains</figcaption></figure><p><strong><em>For free service we cannot add custom SSL</em></strong>, only hobby and upper plan can use SSL, if you have those plan, use heroku certs:add certificate.pem certificate.key</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*XwZWveg2AbyjSrnx4nO8Gg.png" /><figcaption>Generate Certificate Pem and Private Key</figcaption></figure><p>We skip those step if free tier. We set on DNS to redirect subdomain to heroku. On DNS tab fill subdomain name, ex: blog from blog.kusumandaru.com and set domain name from heroku. kusumandaru.herokuapp.com . We use domain name since if we use DNS Target it will cause redirect loop on cloudflare</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*0O0vxWUKftLlvRf6fB2rSA.png" /></figure><p>Than wait for several minutes than website is published</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*j9ZbhqEBps80bCSn2NIq4w.png" /><figcaption>custom domain on heroku free</figcaption></figure><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=e5d2b793fac0" width="1" height="1" alt="">