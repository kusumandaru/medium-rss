---
layout: post
title: Tips mengkonversi .Net Framework ke .Net Core
author: angga kusumandaru
categories: ["Dotnet Core", "Convert", "Dotnet"]
image: https://cdn-images-1.medium.com/max/1024/1*_nypnJvULfcnQ5AbsYfMcQ.png
featured: false
---
<h3>Tips mengkonversi .Net Framework ke .Net Core</h3><p><em>.NET framework</em> atau biasa dikenal dengan <em>dot net</em> adalah <em>framework</em> perangkat lunak yang diproduksi oleh <a href="https://en.wikipedia.org/wiki/Microsoft">Microsoft</a> dan dijalankan pada media Microsoft Windows.</p><p>Dot net berjalan pada perangkat lunak <em>virtual machine</em> (<em>Common Language Runtime) </em>alih-alih menggunakan perangkat keras komputer. Dan <a href="https://en.wikipedia.org/wiki/Common_Language_Runtime">CLR</a> ini berjalan <em>native </em>pada sistem operasi windows. Selain itu dotnet juga bergantung pada kumpulan <em>library </em>Framework Class Library (<a href="https://en.wikipedia.org/wiki/Framework_Class_Library">FCL</a>).</p><p>.Net Core bersifat <em>open source </em>dan gratis dan mampu berjalan pada multi ranah windows, linux, dan mac Os. DotnetCore memiliki CoreCLR, implementasi CLR untuk lintas platform, dan <a href="https://blogs.msdn.microsoft.com/dotnet/2014/12/04/introducing-net-core/">CoreFX</a> yang merupakan <em>porting </em>dari sebagian FCL</p><p>Ada beberapa <em>checklist</em> kapan menggunakan .net kapan menggunakan .netCore.</p><p>Tetap gunakan .net ketika:</p><ul><li>Servernya harus menggunakan Windows Server</li><li>Basis kode saat ini sebagian besar menggunakan .net Framework</li><li><em>Library </em>atau paket <em>nuget </em>belum tersedia di .netcore</li><li>Platform layanan yang digunakan tidak mendukung .net core (beberapa layanan azure membutuhkan net framework seperti azure fabric)</li></ul><p>Gunakan .net Core ketika:</p><ul><li>membutuhkan aplikasi lintas platform</li><li>menggunakan Docker</li><li>membutuhkan <a href="https://blogs.msdn.microsoft.com/dotnet/2017/06/07/performance-improvements-in-net-core/">peforma lebih cepat</a></li></ul><p>Apabila diperlukan <em>porting</em> .net ke .netCore dapat dilakukan dengan beberapa langkah.</p><ol><li>Identifikasi apakah ada <em>third party library </em>pada projek saat ini.</li></ol><p>Kita dapat melakukan pengecekan dengan beberapa cara:</p><p>a. melihat reference pada tiap-tiap proyek.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/598/1*7sB8pZ02YWjg1YfbD-YHOQ.png" /><figcaption>TIdak ada third party</figcaption></figure><p>b. Kita dapat menggunakan <a href="https://github.com/Microsoft/dotnet-apiport">tools apiport</a> untuk mencek kompabilitas dari libary yang kita gunakan.</p><pre>apiport analyzae -f .</pre><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*_nypnJvULfcnQ5AbsYfMcQ.png" /><figcaption>checking library</figcaption></figure><p>API Portability Analyzer tool (apitool) menganalisa dan membuat laporan kesesuaian tiap API yang tidak tersedia di .net core. Dan memberi kita analisa garis besar, bagaimana rencana porting dijalankan.</p><p>Sehingga kita lihat library apa saja yang kompabilitasnya bermasalah.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*D4f7l67AvwC3FhMzCceCfg.png" /><figcaption>portabilitas library</figcaption></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*AKT2x5bQIMMg2WVXUM8azg.png" /><figcaption>Library yang tidak ditemukan</figcaption></figure><p>Dari data diatas dapat disimpulkan bahwa tidak ada library 3rd party yang bermasalah atau dapat dikonversi ke .net core</p><p>Apabila ditemukan library yang tidak kompatibel. Ada beberapa penanganan:</p><ol><li>Bila library itu milik kita sendiri, maka kita harus mengkonversi library itu terlebih dahulu</li><li>Bila itu merupakan milik pihak luar maka kita dapat meminta tiket untuk mengkonversi atau mencari alternatif package lain.</li></ol><p>Kita dapat juga menggunakan situs <a href="https://packagesearch.azurewebsites.net/">packagesearch</a> untuk menemukan alternatif dari <em>package</em> di .net</p><p>Khusus pengguna windows dapat melakukan pengecekan kompabilitas target framework dengan memilih framework 4.7.2 atau diatasnya. Yang akan memunculkan alternatif secara otomatis bila ada target yang tidak disupport .net core.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*3Wg2WI1hP5223jea_1SHpw.png" /><figcaption>Target framework ke 4.7.2 keatas (hanya windows)</figcaption></figure><p>2. Langkah selanjutnya adalah melakukan konversi project.</p><p>Opsi pertama adalah melakukan konversi csproj.</p><p>Ubah csproj dengan Tools-&gt; edit file</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*W6EDpNuqNFIH3Ycez04Ryg.png" /></figure><p>ubah targetFramework menjadi dotnet framework dari &lt;TargetFrameworkVersion&gt;v4.6.2&lt;/TargetFrameworkVersion&gt; ke &lt;TargetFramework&gt;netcoreapp2.1&lt;/TargetFramework&gt;</p><p>Serta pada &lt;ItemGroup&gt; tambahkan &lt;PackageReference Include=”Microsoft.AspNetCore.App” /&gt;</p><p>Jalankan dotnet build untuk me-<em>restore</em> dan <em>build</em>, maka akan muncul hasil apakah project berhasil dibuild atau tidak. Bila tidak maka lakukan beberapa <a href="https://docs.microsoft.com/en-us/aspnet/core/migration/proper-to-2x/?view=aspnetcore-2.2">konfigurasi perbaikan</a>.</p><p>Lakukan perbaikan apabila terjadi masalah saat build.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/580/1*p-nPl17Wl4o-QozY7Ykadw.png" /><figcaption>build berhasil</figcaption></figure><p>Contoh repository dapat dilihat <a href="https://github.com/kusumandaru/message-broker">disini</a>.</p><p>Beberapa kendala yang terkadang muncul pada proses <em>porting</em>:</p><ol><li>Paket tidak ditemukan</li></ol><pre>Global.Flight.Data.csproj : error NU1101: Unable to find package System.Xml. No packages exist with this id in source(s): nuget.org</pre><pre>Global.Flight.Data.csproj : error NU1101: Unable to find package System.Web. No packages exist with this id in source(s): nuget.org</pre><pre>Global.Flight.Data.csproj : error NU1101: Unable to find package System.Data. No packages exist with this id in source(s): nuget.org</pre><p>AspNetCore.App telah berisi set API untuk net Core. Library ini dapat ditambahkan &lt;PackageReference Include=”Microsoft.AspNetCore.App” /&gt; di ItemGroup</p><pre>AssemblyInfo.cs(10,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyCompanyAttribute&#39; attribute </pre><pre>AssemblyInfo.cs(11,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyConfigurationAttribute&#39; attribute </pre><pre>AssemblyInfo.cs(12,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyFileVersionAttribute&#39; attribute </pre><pre>AssemblyInfo.cs(14,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyProductAttribute&#39; attribute </pre><pre>AssemblyInfo.cs(15,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyTitleAttribute&#39; attribute </pre><pre>AssemblyInfo.cs(16,12): error CS0579: Duplicate &#39;System.Reflection.AssemblyVersionAttribute&#39; attribute </pre><p>Hal ini terjadi karena pada .net framework terdapat assembly pada bin atau terdapat berkas Properties\AssemblyInfo.cs Hal ini dapat diakali dengan menambah &lt;GenerateAssemblyInfo&gt;false&lt;/GenerateAssemblyInfo&gt; di PropertyGroup</p><p>Tips personal untuk refaktor ke .net core:</p><ol><li>Refaktor test terlebih dahulu, seminimalnya fungsi utama pada aplikasi dapat tercover sebelum melakukan refaktor menggunakan MSTest, xUnit atau NUnit yang telah disupport net Core</li><li>Buat monolitik terlebih dahulu, bila interface/factory dan library ada di proyek lain satukan terlebih dahulu lalu refaktor apabila tes sudah berjalan sesuai</li></ol><p>Selamat mengkonversi :)</p><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=6a2445b3b8a4" width="1" height="1">
