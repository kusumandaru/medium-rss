---
layout: post
title: Create Dashcam with object detection using Raspberry Pi 4 and Tensorflow Lite
author: ndaru
categories: ["tensorflow-lite", "raspberry-pi", "video-recognition", "video-recording"]
image: https://cdn-images-1.medium.com/max/592/1*_XQ4NC8x7BeEI1B5siu2ig@2x.jpeg
---
<p>Using live detection object with tensorflow and record it on video format with common usb web, make your own dashcam.</p><p>These tutorial combined from <a href="https://github.com/EdjeElectronics/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi/blob/master/Raspberry_Pi_Guide.md">EdjeElectronics</a> article how to build model and run on raspberry Pi, and combined with <a href="https://www.pyimagesearch.com/2016/02/22/writing-to-video-with-opencv/">pyimagesearch</a> tutorial to save video</p><p>In Indonesia, you can bought equipment here:</p><ul><li><a href="https://www.tokopedia.com/rajacell/kamera-usb-camera-8mp-untuk-raspberry-pi-3-model-b-kabel-tarik-retrack">Cheap webcam camera</a></li><li><a href="https://www.bukalapak.com/p/komputer/mini-pc/3dyw77y-jual-raspberry-pi-4-model-b-ram-8-gb-siap-pakai?product_sku=7399366470">Raspberry Pi 4 Complete</a>, it is already include case, memory card, and power cable, since it using dash cam, try to get usb cable.</li><li><a href="https://www.tokopedia.com/rajacell/3pcs-black-aluminium-heatsink-pendingin-heat-sink-raspberry-pi-4-b-3b">Heatsink</a></li><li><a href="https://www.tokopedia.com/rajacell/wireless-mini-keyboard-rii-mini-i8-2-4g-touchpad-remote-support-raspi-hitam">Keyboard wireless</a></li></ul><figure><img alt="" src="https://cdn-images-1.medium.com/max/592/1*_XQ4NC8x7BeEI1B5siu2ig@2x.jpeg" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/640/1*PaPulXEIrpI9n66ZLEtoGw@2x.jpeg" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/288/1*IMgklPSbLQSlqMvfcfXPaQ@2x.jpeg" /></figure><p>Assembly raspberry with memory card, (optional) 3.5 screen and case.</p><p>Connect raspberry into monitor using hdmi. Or install VNC server to remote access using laptop.</p><p>Open terminal and run following steps:</p><ul><li>update raspberry</li></ul><pre>sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</pre><p>Connect webcam with raspberry</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*WQd95dSUeP1OosNeK4zxfg@2x.jpeg" /></figure><figure><img alt="" src="https://cdn-images-1.medium.com/max/1024/1*AW4P9AHdCu_U68MOADth4Q@2x.jpeg" /></figure><ul><li>install webcam driver on raspberry</li></ul><pre># install webcam driver<br>sudo apt-get install fswebcam</pre><ul><li>check webcam work</li></ul><pre># capture image with selected resolution and set output name and format<br>fswebcam -r 640x480 image.jpg</pre><ul><li>download code in <a href="https://github.com/kusumandaru/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi">github repository</a></li></ul><pre># clone object<br>git clone <a href="https://github.com/kusumandaru/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi.git">https://github.com/kusumandaru/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi.git</a></pre><pre># rename directory<br>mv <a href="https://github.com/kusumandaru/TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi.git">TensorFlow-Lite-Object-Detection-on-Android-and-Raspberry-Pi</a> tensorflow-lite-raspberry</pre><pre># go to folder<br>cd tensorflow-lite-raspberry</pre><ul><li>create virtual environment, to separate python library to each project</li></ul><pre># install virtual environement library<br>sudo pip3 install virtualenv</pre><pre># create virtual environment<br>python3 -m venv tflite-env</pre><pre># activate environment<br>source tflite-env/bin/activate</pre><p>keep in mind to re-activate environment when reboot system.</p><ul><li>install dependency</li></ul><pre>bash get_pi_requirements.sh</pre><ul><li>Grab model</li></ul><p>Google have selected model to tensorflow lite such as Image classification, object detection, and other. For these project we use object detection. When passed image it will return confidence score and location object.</p><p>Confidence score: number between 0 and 1 that indicates confidence that the object was genuinely detected. The closer the number is to 1, the more confident the model is. When score is below threshold score it will abandon from result.</p><p>Location: array of four numbers representing a bounding rectangle that surrounds its position consist of: top, down, left, right.</p><p>Google provides a sample quantized SSDLite-MobileNet-v2 object detection model which is trained off the MSCOCO dataset and converted to run on TensorFlow Lite. It can detect and identify 80 different common objects, such as people, cars, cups, etc.</p><pre>wget <a href="https://storage.googleapis.com/download.tensorflow.org/models/tflite/coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip">https://storage.googleapis.com/download.tensorflow.org/models/tflite/coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip</a></pre><pre># to get latest image download <a href="https://www.tensorflow.org/lite/models/object_detection/overview">https://www.tensorflow.org/lite/models/object_detection/overview</a></pre><p>than extract inside tensorflow-lite-raspberrydirectory.</p><pre>unzip coco_ssd_mobilenet_v1_1.0_quant_2018_06_29.zip -d tflite_model</pre><ul><li>running program, it need library to loaded and make sure webcam is record image, detected object will have squared boxes and label displayed in real time.</li></ul><pre>python3 TFLite_detection_dashcam.py — modeldir=tflite_model</pre><p>Since computational power is relative low, it only detect about 4–5 frame per second. To increase power 5–6 times, you can bought <a href="https://coral.ai/products/accelerator/">coral usb accelerator</a></p><p>Sample video can be located below:</p><iframe src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F4XVpRhM-IeM%3Ffeature%3Doembed&amp;display_name=YouTube&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D4XVpRhM-IeM&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F4XVpRhM-IeM%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" width="640" height="480" frameborder="0" scrolling="no"><a href="https://medium.com/media/0e85d37b8563c800f60a82eb4fb1079e/href">https://medium.com/media/0e85d37b8563c800f60a82eb4fb1079e/href</a></iframe><img src="https://medium.com/_/stat?event=post.clientViewed&referrerSource=full_rss&postId=cdec3e105e55" width="1" height="1" alt="">